---
- name: Sync Router Interfaces til NetBox
  hosts: all
  gather_facts: no
  connection: network_cli
  
  tasks:
    - name: Hent facts fra Router (Læs interfaces)
      cisco.ios.ios_facts:
        gather_subset:
          - interfaces
          - all

    - name: Opret/Opdater Interfaces i NetBox
      netbox.netbox.netbox_device_interface:
        netbox_url: "https://10.36.1.80"
        netbox_token: "DdQEEtl583idIa6TtA3avkxsyhxncqPirUO198BM"
        validate_certs: no   # <--- HER ER FIXET! (Ignorer SSL fejl)
        data:
          device: "{{ inventory_hostname }}"
          name: "{{ item.key }}"
          type: "1000base-t"
          
          # Sætter MTU (default 1500 hvis den mangler)
          mtu: "{{ item.value.mtu | default(1500) | int }}"
          
          description: "{{ item.value.description | default('Importeret fra Ansible') }}"
        state: present
      loop: "{{ ansible_net_interfaces | dict2items }}"
      delegate_to: localhost
